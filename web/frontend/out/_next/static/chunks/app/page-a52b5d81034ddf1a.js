(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1154:function(e,s,a){Promise.resolve().then(a.bind(a,1236))},1236:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return ef}});var t=a(3827),r=a(4090),n=a(9769),i=a(3167),l=a(1367);function c(){for(var e=arguments.length,s=Array(e),a=0;a<e;a++)s[a]=arguments[a];return(0,l.m6)((0,i.W)(s))}let d=(0,n.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=r.forwardRef((e,s)=>{let{className:a,variant:r,size:n,...i}=e;return(0,t.jsx)("button",{className:c(d({variant:r,size:n,className:a})),ref:s,...i})});o.displayName="Button";let m=r.forwardRef((e,s)=>{let{className:a,type:r,...n}=e;return(0,t.jsx)("input",{type:r,className:c("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:s,...n})});m.displayName="Input";let x=(0,n.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),u=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("label",{ref:s,className:c(x(),a),...r})});u.displayName="Label";let h=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:c("rounded-lg border bg-card text-card-foreground shadow-sm",a),...r})});h.displayName="Card";let f=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:c("flex flex-col space-y-1.5 p-6",a),...r})});f.displayName="CardHeader";let p=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("h3",{ref:s,className:c("text-2xl font-semibold leading-none tracking-tight",a),...r})});p.displayName="CardTitle";let j=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("p",{ref:s,className:c("text-sm text-muted-foreground",a),...r})});j.displayName="CardDescription";let g=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:c("p-6 pt-0",a),...r})});g.displayName="CardContent",r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:c("flex items-center p-6 pt-0",a),...r})}).displayName="CardFooter";var v=a(7841);function N(e){let{size:s="md",showText:a=!0}=e;return(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"".concat({sm:"h-6 w-6",md:"h-10 w-10",lg:"h-16 w-16"}[s]," text-primary"),children:(0,t.jsx)(v.Z,{className:"w-full h-full"})}),a&&(0,t.jsx)("span",{className:"font-bold ".concat({sm:"text-lg",md:"text-2xl",lg:"text-4xl"}[s]," tracking-tight"),children:"MVISION"})]})}let y="/api";async function b(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=await fetch("".concat(y).concat(e),{...s,headers:{"Content-Type":"application/json",...s.headers},credentials:"include"});if(!a.ok)throw Error((await a.json().catch(()=>({detail:"Erro desconhecido"}))).detail||"HTTP ".concat(a.status));return a.json()}async function w(e){return b("/auth/login",{method:"POST",body:JSON.stringify({password:e})})}async function E(){return b("/auth/logout",{method:"POST"})}async function S(){return b("/auth/check")}async function k(e,s){return b("/auth/password",{method:"POST",body:JSON.stringify({current_password:e,new_password:s})})}async function C(){return b("/config")}async function _(e){return b("/config",{method:"POST",body:JSON.stringify(e)})}async function A(){return b("/settings")}async function R(e){return b("/settings",{method:"POST",body:JSON.stringify(e)})}async function O(){return b("/system/info")}async function T(){return b("/system/status")}async function I(){return b("/system/restart",{method:"POST"})}async function Z(){return b("/diagnostics/images")}function D(e){return"".concat(y,"/diagnostics/images/").concat(encodeURIComponent(e))}async function F(){return b("/diagnostics/logs/files")}async function M(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=new URLSearchParams;e.file&&s.set("file",e.file),e.level&&s.set("level",e.level),e.category&&s.set("category",e.category),e.search&&s.set("search",e.search),void 0!==e.limit&&s.set("limit",e.limit.toString()),void 0!==e.offset&&s.set("offset",e.offset.toString());let a=s.toString();return b("/diagnostics/logs".concat(a?"?".concat(a):""))}var P=a(8994);function L(e){let{onSuccess:s}=e,[a,n]=(0,r.useState)(""),[i,l]=(0,r.useState)(""),[c,d]=(0,r.useState)(!1),x=async e=>{e.preventDefault(),l(""),d(!0);try{await w(a),s()}catch(e){l(e instanceof Error?e.message:"Erro ao fazer login")}finally{d(!1)}};return(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center p-4",children:(0,t.jsxs)(h,{className:"w-full max-w-md",children:[(0,t.jsxs)(f,{className:"text-center",children:[(0,t.jsx)("div",{className:"flex justify-center mb-4",children:(0,t.jsx)(N,{size:"lg"})}),(0,t.jsx)(p,{children:"Sistema de Monitoramento"}),(0,t.jsx)(j,{children:"Entre com sua senha para acessar as configura\xe7\xf5es"})]}),(0,t.jsx)(g,{children:(0,t.jsxs)("form",{onSubmit:x,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u,{htmlFor:"password",children:"Senha"}),(0,t.jsx)(m,{id:"password",type:"password",placeholder:"Digite sua senha",value:a,onChange:e=>n(e.target.value),autoFocus:!0})]}),i&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:i}),(0,t.jsx)(o,{type:"submit",className:"w-full",disabled:c,children:c?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(P.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Entrando..."]}):"Entrar"})]})})]})})}var z=a(2235);let H=r.createContext(void 0);function V(e){let{children:s}=e,[a,n]=r.useState([]),i=r.useCallback(e=>{let s=Math.random().toString(36).substr(2,9);n(a=>[...a,{...e,id:s}]),setTimeout(()=>{n(e=>e.filter(e=>e.id!==s))},5e3)},[]),l=r.useCallback(e=>{n(s=>s.filter(s=>s.id!==e))},[]);return(0,t.jsxs)(H.Provider,{value:{toasts:a,addToast:i,removeToast:l},children:[s,(0,t.jsx)(B,{})]})}function B(){let e=r.useContext(H);if(!e)return null;let{toasts:s,removeToast:a}=e;return(0,t.jsx)("div",{className:"fixed bottom-4 right-4 z-50 flex flex-col gap-2 w-80",children:s.map(e=>(0,t.jsx)("div",{className:c("rounded-lg border p-4 shadow-lg transition-all","bg-card text-card-foreground","success"===e.variant&&"border-green-500/50 bg-green-500/10","destructive"===e.variant&&"border-red-500/50 bg-red-500/10"),children:(0,t.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:e.title}),e.description&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:e.description})]}),(0,t.jsx)("button",{onClick:()=>a(e.id),className:"text-muted-foreground hover:text-foreground",children:(0,t.jsx)(z.Z,{className:"h-4 w-4"})})]})},e.id))})}function K(){let e=r.useContext(H);if(!e)throw Error("useToast must be used within a ToastProvider");return{toast:e.addToast}}var q=a(3879),U=a(699);function W(e){let{initialConfig:s,onBack:a}=e,[n,i]=(0,r.useState)(s),[l,c]=(0,r.useState)(!1),{toast:d}=K(),x=(e,s)=>{i(a=>({...a,[e]:s}))},v=async e=>{e.preventDefault(),c(!0);try{let e=await _(n);d({title:"Sucesso",description:e.message,variant:"success"})}catch(e){d({title:"Erro ao salvar",description:e instanceof Error?e.message:"Erro desconhecido",variant:"destructive"})}finally{c(!1)}};return(0,t.jsx)("div",{className:"min-h-screen p-4 md:p-8",children:(0,t.jsxs)("div",{className:"max-w-xl mx-auto",children:[(0,t.jsxs)(o,{variant:"ghost",onClick:a,className:"mb-4",children:[(0,t.jsx)(q.Z,{className:"h-4 w-4 mr-2"}),"Voltar"]}),(0,t.jsxs)(h,{children:[(0,t.jsxs)(f,{children:[(0,t.jsx)(p,{children:"Configuracao do Dispositivo"}),(0,t.jsx)(j,{children:"Configure a identificacao deste equipamento"})]}),(0,t.jsx)(g,{children:(0,t.jsxs)("form",{onSubmit:v,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u,{htmlFor:"environment_id",children:"ID do Ambiente"}),(0,t.jsx)(m,{id:"environment_id",placeholder:"Ex: UTI-LEITO-01",value:n.environment_id,onChange:e=>x("environment_id",e.target.value)}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Identificador unico deste dispositivo"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u,{htmlFor:"hospital",children:"Hospital"}),(0,t.jsx)(m,{id:"hospital",placeholder:"Nome do hospital",value:n.hospital,onChange:e=>x("hospital",e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u,{htmlFor:"sector",children:"Setor"}),(0,t.jsx)(m,{id:"sector",placeholder:"Ex: UTI, Enfermaria, Emergencia",value:n.sector,onChange:e=>x("sector",e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u,{htmlFor:"bed",children:"Leito"}),(0,t.jsx)(m,{id:"bed",placeholder:"Numero do leito",value:n.bed,onChange:e=>x("bed",e.target.value)})]}),(0,t.jsx)(o,{type:"submit",className:"w-full",disabled:l,children:l?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(P.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Salvando..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(U.Z,{className:"h-4 w-4 mr-2"}),"Salvar Configuracao"]})})]})})]})]})})}let G=r.forwardRef((e,s)=>{let{className:a,onCheckedChange:r,checked:n,...i}=e;return(0,t.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",className:"sr-only peer",ref:s,checked:n,onChange:e=>{r&&r(e.target.checked)},...i}),(0,t.jsx)("div",{className:c("w-11 h-6 bg-secondary rounded-full peer","peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full","after:content-[''] after:absolute after:top-[2px] after:start-[2px]","after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all","peer-checked:bg-primary peer-focus-visible:ring-2 peer-focus-visible:ring-ring",a)})]})});function J(e){let{onBack:s}=e,[a,n]=(0,r.useState)(null),[i,l]=(0,r.useState)(!0),[c,d]=(0,r.useState)(!1),{toast:x}=K();(0,r.useEffect)(()=>{v()},[]);let v=async()=>{try{let e=await A();n(e)}catch(e){x({title:"Erro ao carregar",description:e instanceof Error?e.message:"Erro desconhecido",variant:"destructive"})}finally{l(!1)}},N=(e,s)=>{a&&n({...a,[e]:s})},y=(e,s)=>{if(a){let t=parseFloat(s);isNaN(t)||n({...a,[e]:t})}},b=async e=>{if(e.preventDefault(),a){d(!0);try{let e=await R(a);x({title:"Sucesso",description:e.message,variant:"success"})}catch(e){x({title:"Erro ao salvar",description:e instanceof Error?e.message:"Erro desconhecido",variant:"destructive"})}finally{d(!1)}}};return i?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)(P.Z,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):a?(0,t.jsx)("div",{className:"min-h-screen p-4 md:p-8",children:(0,t.jsxs)("div",{className:"max-w-xl mx-auto",children:[(0,t.jsxs)(o,{variant:"ghost",onClick:s,className:"mb-4",children:[(0,t.jsx)(q.Z,{className:"h-4 w-4 mr-2"}),"Voltar"]}),(0,t.jsxs)(h,{children:[(0,t.jsxs)(f,{children:[(0,t.jsx)(p,{children:"Configuracoes do Sistema"}),(0,t.jsx)(j,{children:"Ajustes avancados do monitoramento"})]}),(0,t.jsx)(g,{children:(0,t.jsxs)("form",{onSubmit:b,className:"space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Modo de Operacao"}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsx)(u,{children:"Modo Desenvolvedor"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Salva imagens de alerta para debug"})]}),(0,t.jsx)(G,{checked:a.DEV_MODE,onCheckedChange:e=>N("DEV_MODE",e)})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsx)(u,{children:"Pular Deteccao de Leito"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Ignora calibracao de leito"})]}),(0,t.jsx)(G,{checked:a.DEV_SKIP_BED_DETECTION,onCheckedChange:e=>N("DEV_SKIP_BED_DETECTION",e)})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsx)(u,{children:"Espelhar Imagem"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Inverte a imagem horizontalmente"})]}),(0,t.jsx)(G,{checked:a.FLIP_HORIZONTAL,onCheckedChange:e=>N("FLIP_HORIZONTAL",e)})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Parametros de Deteccao"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u,{htmlFor:"bed_recheck",children:"Verificar Leito (horas)"}),(0,t.jsx)(m,{id:"bed_recheck",type:"number",min:"1",value:a.BED_RECHECK_INTERVAL_HOURS,onChange:e=>y("BED_RECHECK_INTERVAL_HOURS",e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u,{htmlFor:"pose_frames",children:"Frames p/ Confirmar"}),(0,t.jsx)(m,{id:"pose_frames",type:"number",min:"1",value:a.POSE_FRAMES_TO_CONFIRM,onChange:e=>y("POSE_FRAMES_TO_CONFIRM",e.target.value)})]})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Suavizacao (EMA)"}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u,{htmlFor:"ema_alpha",children:"Alpha"}),(0,t.jsx)(m,{id:"ema_alpha",type:"number",step:"0.1",min:"0",max:"1",value:a.EMA_ALPHA,onChange:e=>y("EMA_ALPHA",e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u,{htmlFor:"ema_enter",children:"Entrar Risco"}),(0,t.jsx)(m,{id:"ema_enter",type:"number",step:"0.1",min:"0",max:"1",value:a.EMA_THRESHOLD_ENTER_RISK,onChange:e=>y("EMA_THRESHOLD_ENTER_RISK",e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u,{htmlFor:"ema_exit",children:"Sair Risco"}),(0,t.jsx)(m,{id:"ema_exit",type:"number",step:"0.1",min:"0",max:"1",value:a.EMA_THRESHOLD_EXIT_RISK,onChange:e=>y("EMA_THRESHOLD_EXIT_RISK",e.target.value)})]})]})]}),(0,t.jsx)(o,{type:"submit",className:"w-full",disabled:c,children:c?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(P.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Salvando..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(U.Z,{className:"h-4 w-4 mr-2"}),"Salvar Configuracoes"]})})]})})]})]})}):(0,t.jsx)("div",{className:"min-h-screen p-4 md:p-8",children:(0,t.jsxs)("div",{className:"max-w-xl mx-auto",children:[(0,t.jsxs)(o,{variant:"ghost",onClick:s,className:"mb-4",children:[(0,t.jsx)(q.Z,{className:"h-4 w-4 mr-2"}),"Voltar"]}),(0,t.jsx)("p",{className:"text-center text-muted-foreground",children:"Erro ao carregar configuracoes"})]})})}function X(e){let{onBack:s}=e,[a,n]=(0,r.useState)(""),[i,l]=(0,r.useState)(""),[c,d]=(0,r.useState)(""),[x,v]=(0,r.useState)(!1),{toast:N}=K(),y=async e=>{if(e.preventDefault(),i!==c){N({title:"Erro",description:"As senhas nao coincidem",variant:"destructive"});return}if(i.length<6){N({title:"Erro",description:"A nova senha deve ter pelo menos 6 caracteres",variant:"destructive"});return}v(!0);try{let e=await k(a,i);N({title:"Sucesso",description:e.message,variant:"success"}),n(""),l(""),d("")}catch(e){N({title:"Erro ao alterar senha",description:e instanceof Error?e.message:"Erro desconhecido",variant:"destructive"})}finally{v(!1)}};return(0,t.jsx)("div",{className:"min-h-screen p-4 md:p-8",children:(0,t.jsxs)("div",{className:"max-w-md mx-auto",children:[(0,t.jsxs)(o,{variant:"ghost",onClick:s,className:"mb-4",children:[(0,t.jsx)(q.Z,{className:"h-4 w-4 mr-2"}),"Voltar"]}),(0,t.jsxs)(h,{children:[(0,t.jsxs)(f,{children:[(0,t.jsx)(p,{children:"Alterar Senha"}),(0,t.jsx)(j,{children:"Atualize a senha de acesso ao sistema"})]}),(0,t.jsx)(g,{children:(0,t.jsxs)("form",{onSubmit:y,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u,{htmlFor:"current",children:"Senha Atual"}),(0,t.jsx)(m,{id:"current",type:"password",value:a,onChange:e=>n(e.target.value),required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u,{htmlFor:"new",children:"Nova Senha"}),(0,t.jsx)(m,{id:"new",type:"password",value:i,onChange:e=>l(e.target.value),required:!0,minLength:6}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Minimo de 6 caracteres"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u,{htmlFor:"confirm",children:"Confirmar Nova Senha"}),(0,t.jsx)(m,{id:"confirm",type:"password",value:c,onChange:e=>d(e.target.value),required:!0})]}),(0,t.jsx)(o,{type:"submit",className:"w-full",disabled:x,children:x?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(P.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Salvando..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(U.Z,{className:"h-4 w-4 mr-2"}),"Alterar Senha"]})})]})})]})]})})}G.displayName="Switch";var Q=a(1524),Y=a(8998),$=a(5561);function ee(e){let{onBack:s}=e,[a,n]=(0,r.useState)([]),[i,l]=(0,r.useState)(!0),[c,d]=(0,r.useState)(!0),[m,x]=(0,r.useState)(null),{toast:u}=K();(0,r.useEffect)(()=>{v()},[]);let v=async()=>{try{let e=await Z();n(e.images),l(e.dev_mode)}catch(e){u({title:"Erro ao carregar",description:e instanceof Error?e.message:"Erro desconhecido",variant:"destructive"})}finally{d(!1)}},N=e=>{let s=e.match(/(\d{4})(\d{2})(\d{2})_(\d{2})(\d{2})(\d{2})/);if(s){let[,e,a,t,r,n,i]=s;return"".concat(t,"/").concat(a,"/").concat(e," ").concat(r,":").concat(n,":").concat(i)}return e},y=e=>"RISCO_POTENCIAL"===e?(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",children:[(0,t.jsx)(Q.Z,{className:"h-3 w-3"}),"Risco Potencial"]}):"PACIENTE_FORA"===e?(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",children:[(0,t.jsx)(Y.Z,{className:"h-3 w-3"}),"Paciente Fora"]}):(0,t.jsx)("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200",children:e});return c?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)(P.Z,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):i?(0,t.jsx)("div",{className:"min-h-screen p-4 md:p-8",children:(0,t.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,t.jsxs)(o,{variant:"ghost",onClick:s,className:"mb-4",children:[(0,t.jsx)(q.Z,{className:"h-4 w-4 mr-2"}),"Voltar"]}),(0,t.jsxs)(h,{children:[(0,t.jsxs)(f,{children:[(0,t.jsxs)(p,{className:"flex items-center gap-2",children:[(0,t.jsx)($.Z,{className:"h-5 w-5"}),"Imagens de Alerta"]}),(0,t.jsxs)(j,{children:[a.length," imagens capturadas (maximo: 50)"]})]}),(0,t.jsx)(g,{children:0===a.length?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)($.Z,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Nenhuma imagem de alerta capturada"})]}):(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:a.map(e=>(0,t.jsxs)("div",{className:"group relative aspect-video bg-muted rounded-lg overflow-hidden cursor-pointer hover:ring-2 hover:ring-primary transition-all",onClick:()=>x(e),children:[(0,t.jsx)("img",{src:D(e.filename),alt:"Alerta ".concat(e.state),className:"w-full h-full object-cover",loading:"lazy"}),(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),(0,t.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 p-2",children:[y(e.state),(0,t.jsx)("p",{className:"text-xs text-white/80 mt-1 opacity-0 group-hover:opacity-100 transition-opacity",children:N(e.timestamp)})]})]},e.filename))})})]}),m&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 bg-black/80 flex items-center justify-center p-4",onClick:()=>x(null),children:(0,t.jsxs)("div",{className:"relative max-w-4xl w-full bg-background rounded-lg overflow-hidden",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("div",{className:"absolute top-2 right-2 z-10",children:(0,t.jsx)(o,{variant:"ghost",size:"sm",className:"bg-black/50 hover:bg-black/70 text-white",onClick:()=>x(null),children:(0,t.jsx)(z.Z,{className:"h-4 w-4"})})}),(0,t.jsx)("img",{src:D(m.filename),alt:"Alerta ".concat(m.state),className:"w-full h-auto"}),(0,t.jsxs)("div",{className:"p-4 bg-background",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[y(m.state),(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:N(m.timestamp)})]}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground mt-2",children:[m.filename," (",m.size_kb," KB)"]})]})]})})]})}):(0,t.jsx)("div",{className:"min-h-screen p-4 md:p-8",children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,t.jsxs)(o,{variant:"ghost",onClick:s,className:"mb-4",children:[(0,t.jsx)(q.Z,{className:"h-4 w-4 mr-2"}),"Voltar"]}),(0,t.jsxs)(h,{children:[(0,t.jsxs)(f,{children:[(0,t.jsxs)(p,{className:"flex items-center gap-2",children:[(0,t.jsx)($.Z,{className:"h-5 w-5"}),"Imagens de Alerta"]}),(0,t.jsx)(j,{children:"Capturas de tela em momentos de alerta"})]}),(0,t.jsx)(g,{children:(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(Q.Z,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,t.jsx)("p",{className:"text-lg font-medium",children:"DEV_MODE Desabilitado"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"As imagens de alerta so sao capturadas quando o modo desenvolvedor esta ativo."}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Ative DEV_MODE nas configuracoes para habilitar esta funcionalidade."})]})})]})]})})}var es=a(9475),ea=a(7211),et=a(834),er=a(8670),en=a(9108),ei=a(7805);function el(e){let{onBack:s}=e,[a,n]=(0,r.useState)([]),[i,l]=(0,r.useState)([]),[c,d]=(0,r.useState)(0),[x,u]=(0,r.useState)(!0),[v,N]=(0,r.useState)("alerts.log"),[y,b]=(0,r.useState)(""),[w,E]=(0,r.useState)(""),[S,k]=(0,r.useState)(""),[C,_]=(0,r.useState)(0),[A,R]=(0,r.useState)(!1),{toast:O}=K(),T=(0,r.useCallback)(async()=>{u(!0);try{let e=await M({file:v,level:y||void 0,category:w||void 0,search:S||void 0,limit:50,offset:50*C});n(e.entries),d(e.total_lines)}catch(e){O({title:"Erro ao carregar logs",description:e instanceof Error?e.message:"Erro desconhecido",variant:"destructive"})}finally{u(!1)}},[v,y,w,S,C,O]),I=async()=>{try{let e=await F();l(e.files)}catch(e){}};(0,r.useEffect)(()=>{I()},[]),(0,r.useEffect)(()=>{T()},[T]);let Z=e=>{N(e),_(0)},D=()=>{_(0),T()},L=Math.ceil(c/50),H=e=>{switch(e){case"ERROR":return(0,t.jsx)("span",{className:"inline-flex px-2 py-0.5 rounded text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",children:"ERROR"});case"WARNING":return(0,t.jsx)("span",{className:"inline-flex px-2 py-0.5 rounded text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",children:"WARNING"});default:return(0,t.jsx)("span",{className:"inline-flex px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",children:"INFO"})}},V=e=>{switch(e){case"ALERTA":return(0,t.jsx)("span",{className:"inline-flex px-2 py-0.5 rounded text-xs font-medium bg-red-50 text-red-700 dark:bg-red-950 dark:text-red-300",children:"ALERTA"});case"TRANSICAO":return(0,t.jsx)("span",{className:"inline-flex px-2 py-0.5 rounded text-xs font-medium bg-purple-50 text-purple-700 dark:bg-purple-950 dark:text-purple-300",children:"TRANSICAO"});case"SISTEMA":return(0,t.jsx)("span",{className:"inline-flex px-2 py-0.5 rounded text-xs font-medium bg-green-50 text-green-700 dark:bg-green-950 dark:text-green-300",children:"SISTEMA"});default:return(0,t.jsx)("span",{className:"inline-flex px-2 py-0.5 rounded text-xs font-medium bg-gray-50 text-gray-700 dark:bg-gray-900 dark:text-gray-300",children:e})}};return(0,t.jsx)("div",{className:"min-h-screen p-4 md:p-8",children:(0,t.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,t.jsxs)(o,{variant:"ghost",onClick:s,className:"mb-4",children:[(0,t.jsx)(q.Z,{className:"h-4 w-4 mr-2"}),"Voltar"]}),(0,t.jsxs)(h,{children:[(0,t.jsx)(f,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)(p,{className:"flex items-center gap-2",children:[(0,t.jsx)(es.Z,{className:"h-5 w-5"}),"Logs do Sistema"]}),(0,t.jsxs)(j,{children:[c," entradas encontradas"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(o,{variant:"outline",size:"sm",onClick:()=>R(!A),children:[(0,t.jsx)(ea.Z,{className:"h-4 w-4 mr-2"}),"Filtros"]}),(0,t.jsx)(o,{variant:"outline",size:"sm",onClick:T,disabled:x,children:(0,t.jsx)(et.Z,{className:"h-4 w-4 ".concat(x?"animate-spin":"")})})]})]})}),(0,t.jsxs)(g,{className:"space-y-4",children:[(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:i.length>0?i.map(e=>(0,t.jsxs)(o,{variant:v===e.filename?"default":"outline",size:"sm",onClick:()=>Z(e.filename),children:[e.filename,(0,t.jsxs)("span",{className:"ml-2 text-xs opacity-70",children:["(",e.size_kb," KB)"]})]},e.filename)):(0,t.jsx)(o,{variant:"default",size:"sm",disabled:!0,children:"alerts.log"})}),A&&(0,t.jsxs)("div",{className:"p-4 bg-muted/50 rounded-lg space-y-3",children:[(0,t.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,t.jsx)("label",{className:"text-xs text-muted-foreground mb-1 block",children:"Buscar"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(m,{placeholder:"Texto livre...",value:S,onChange:e=>k(e.target.value),onKeyDown:e=>"Enter"===e.key&&D(),className:"flex-1"}),(0,t.jsx)(o,{size:"sm",onClick:D,children:(0,t.jsx)(er.Z,{className:"h-4 w-4"})})]})]}),(0,t.jsxs)("div",{className:"w-32",children:[(0,t.jsx)("label",{className:"text-xs text-muted-foreground mb-1 block",children:"Nivel"}),(0,t.jsxs)("select",{className:"w-full h-9 px-3 rounded-md border border-input bg-background text-sm",value:y,onChange:e=>{b(e.target.value),_(0)},children:[(0,t.jsx)("option",{value:"",children:"Todos"}),(0,t.jsx)("option",{value:"INFO",children:"INFO"}),(0,t.jsx)("option",{value:"WARNING",children:"WARNING"}),(0,t.jsx)("option",{value:"ERROR",children:"ERROR"})]})]}),(0,t.jsxs)("div",{className:"w-32",children:[(0,t.jsx)("label",{className:"text-xs text-muted-foreground mb-1 block",children:"Categoria"}),(0,t.jsxs)("select",{className:"w-full h-9 px-3 rounded-md border border-input bg-background text-sm",value:w,onChange:e=>{E(e.target.value),_(0)},children:[(0,t.jsx)("option",{value:"",children:"Todas"}),(0,t.jsx)("option",{value:"SISTEMA",children:"SISTEMA"}),(0,t.jsx)("option",{value:"TRANSICAO",children:"TRANSICAO"}),(0,t.jsx)("option",{value:"ALERTA",children:"ALERTA"})]})]})]}),(y||w||S)&&(0,t.jsxs)(o,{variant:"ghost",size:"sm",onClick:()=>{b(""),E(""),k(""),_(0)},children:[(0,t.jsx)(z.Z,{className:"h-4 w-4 mr-2"}),"Limpar filtros"]})]}),x?(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsx)(P.Z,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):0===a.length?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)(es.Z,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Nenhuma entrada encontrada"})]}):(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b",children:[(0,t.jsx)("th",{className:"text-left py-2 px-2 font-medium text-muted-foreground w-8",children:"#"}),(0,t.jsx)("th",{className:"text-left py-2 px-2 font-medium text-muted-foreground w-40",children:"Timestamp"}),(0,t.jsx)("th",{className:"text-left py-2 px-2 font-medium text-muted-foreground w-20",children:"Nivel"}),(0,t.jsx)("th",{className:"text-left py-2 px-2 font-medium text-muted-foreground w-28",children:"Categoria"}),(0,t.jsx)("th",{className:"text-left py-2 px-2 font-medium text-muted-foreground",children:"Detalhes"})]})}),(0,t.jsx)("tbody",{children:a.map(e=>(0,t.jsxs)("tr",{className:"border-b hover:bg-muted/50",children:[(0,t.jsx)("td",{className:"py-2 px-2 text-muted-foreground font-mono text-xs",children:e.line_number}),(0,t.jsx)("td",{className:"py-2 px-2 font-mono text-xs whitespace-nowrap",children:e.timestamp||"-"}),(0,t.jsx)("td",{className:"py-2 px-2",children:H(e.level)}),(0,t.jsx)("td",{className:"py-2 px-2",children:V(e.category)}),(0,t.jsx)("td",{className:"py-2 px-2 font-mono text-xs break-all",children:e.details})]},e.line_number))})]})}),L>1&&(0,t.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t",children:[(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Pagina ",C+1," de ",L]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(o,{variant:"outline",size:"sm",onClick:()=>_(e=>Math.max(0,e-1)),disabled:0===C||x,children:[(0,t.jsx)(en.Z,{className:"h-4 w-4"}),"Anterior"]}),(0,t.jsxs)(o,{variant:"outline",size:"sm",onClick:()=>_(e=>Math.min(L-1,e+1)),disabled:C>=L-1||x,children:["Proximo",(0,t.jsx)(ei.Z,{className:"h-4 w-4"})]})]})]})]})]})]})})}var ec=a(1049),ed=a(3013),eo=a(9910),em=a(695),ex=a(1530),eu=a(933);function eh(e){let{onLogout:s}=e,[a,n]=(0,r.useState)("dashboard"),[i,l]=(0,r.useState)(null),[c,d]=(0,r.useState)(null),[m,x]=(0,r.useState)(null),[u,v]=(0,r.useState)(null),[y,b]=(0,r.useState)(!0),[w,S]=(0,r.useState)(!1),{toast:k}=K(),_=async()=>{try{let[e,s,a,t]=await Promise.all([C(),O(),T(),A()]);l(e),d(s),x(a),v(t)}catch(e){k({title:"Erro ao carregar dados",description:e instanceof Error?e.message:"Erro desconhecido",variant:"destructive"})}finally{b(!1)}};(0,r.useEffect)(()=>{_()},[]);let R=async()=>{try{await E(),s()}catch(e){k({title:"Erro ao sair",description:e instanceof Error?e.message:"Erro desconhecido",variant:"destructive"})}},Z=async()=>{S(!0);try{let e=await I();k({title:e.success?"Sucesso":"Erro",description:e.message,variant:e.success?"success":"destructive"}),setTimeout(_,2e3)}catch(e){k({title:"Erro ao reiniciar",description:e instanceof Error?e.message:"Erro desconhecido",variant:"destructive"})}finally{S(!1)}};return y?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)(P.Z,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):"device"===a?(0,t.jsx)(W,{initialConfig:i,onBack:()=>{n("dashboard"),_()}}):"settings"===a?(0,t.jsx)(J,{onBack:()=>n("dashboard")}):"password"===a?(0,t.jsx)(X,{onBack:()=>n("dashboard")}):"images"===a?(0,t.jsx)(ee,{onBack:()=>n("dashboard")}):"logs"===a?(0,t.jsx)(el,{onBack:()=>n("dashboard")}):(0,t.jsx)("div",{className:"min-h-screen p-4 md:p-8",children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,t.jsxs)("header",{className:"flex items-center justify-between mb-8",children:[(0,t.jsx)(N,{}),(0,t.jsxs)(o,{variant:"outline",size:"sm",onClick:R,children:[(0,t.jsx)(ec.Z,{className:"h-4 w-4 mr-2"}),"Sair"]})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,t.jsxs)(h,{className:"cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>n("device"),children:[(0,t.jsxs)(f,{children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(ed.Z,{className:"h-6 w-6 text-primary"}),(0,t.jsx)(p,{className:"text-lg",children:"Dispositivo"})]}),(0,t.jsx)(j,{children:"Configura\xe7\xe3o do ambiente"})]}),(0,t.jsxs)(g,{children:[(0,t.jsx)("p",{className:"text-xl font-semibold",children:(null==i?void 0:i.environment_id)||"N\xe3o configurado"}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:[null==i?void 0:i.hospital," - ",null==i?void 0:i.sector]})]})]}),(0,t.jsxs)(h,{className:"cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>n("settings"),children:[(0,t.jsxs)(f,{children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(eo.Z,{className:"h-6 w-6 text-primary"}),(0,t.jsx)(p,{className:"text-lg",children:"Configuracoes"})]}),(0,t.jsx)(j,{children:"Ajustes do sistema"})]}),(0,t.jsx)(g,{children:(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Modo desenvolvedor, deteccao, EMA..."})})]}),(0,t.jsxs)(h,{children:[(0,t.jsxs)(f,{children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(em.Z,{className:"h-6 w-6 text-primary"}),(0,t.jsx)(p,{className:"text-lg",children:"Sistema"})]}),(0,t.jsx)(j,{children:"Status do servico principal"})]}),(0,t.jsxs)(g,{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"h-3 w-3 rounded-full ".concat((null==m?void 0:m.running)?"bg-green-500":"bg-red-500")}),(0,t.jsx)("span",{children:(null==m?void 0:m.running)?"Online":"Offline"})]}),c&&(0,t.jsxs)("div",{className:"text-sm text-muted-foreground space-y-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(ex.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:c.ip_addresses[0]||"N/A"})]}),(0,t.jsxs)("p",{children:["Host: ",c.hostname]})]}),(0,t.jsx)(o,{variant:"outline",size:"sm",onClick:Z,disabled:w,children:w?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(P.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Reiniciando..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(et.Z,{className:"h-4 w-4 mr-2"}),"Reiniciar Servico"]})})]})]}),(0,t.jsxs)(h,{className:"cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>n("password"),children:[(0,t.jsxs)(f,{children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(eu.Z,{className:"h-6 w-6 text-primary"}),(0,t.jsx)(p,{className:"text-lg",children:"Seguranca"})]}),(0,t.jsx)(j,{children:"Alterar senha de acesso"})]}),(0,t.jsx)(g,{children:(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Clique para alterar a senha"})})]}),(0,t.jsxs)(h,{className:"cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>n("logs"),children:[(0,t.jsxs)(f,{children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(es.Z,{className:"h-6 w-6 text-primary"}),(0,t.jsx)(p,{className:"text-lg",children:"Logs"})]}),(0,t.jsx)(j,{children:"Historico de eventos do sistema"})]}),(0,t.jsx)(g,{children:(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Visualizar alertas, transicoes e eventos"})})]}),(null==u?void 0:u.DEV_MODE)&&(0,t.jsxs)(h,{className:"cursor-pointer hover:border-primary/50 transition-colors border-yellow-500/30",onClick:()=>n("images"),children:[(0,t.jsxs)(f,{children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)($.Z,{className:"h-6 w-6 text-yellow-500"}),(0,t.jsx)(p,{className:"text-lg",children:"Imagens DEV"})]}),(0,t.jsx)(j,{children:"Capturas de alertas (modo dev)"})]}),(0,t.jsx)(g,{children:(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Imagens salvas durante alertas"})})]})]})]})})}function ef(){let[e,s]=(0,r.useState)(null);return((0,r.useEffect)(()=>{S().then(e=>{let{authenticated:a}=e;return s(a)}).catch(()=>s(!1))},[]),null===e)?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)(P.Z,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):(0,t.jsx)(V,{children:e?(0,t.jsx)(eh,{onLogout:()=>s(!1)}):(0,t.jsx)(L,{onSuccess:()=>s(!0)})})}}},function(e){e.O(0,[631,971,69,744],function(){return e(e.s=1154)}),_N_E=e.O()}]);